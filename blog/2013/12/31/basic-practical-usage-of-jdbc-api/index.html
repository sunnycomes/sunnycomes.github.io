
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Basic Practical Usage of JDBC API - My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="The first version is completed on 2013.12.22 20:38, the main content is from here, thanks to the origin author Mark Chamness.This post is dedicated &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sunnycomes.github.io/blog/2013/12/31/basic-practical-usage-of-jdbc-api">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43860851-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Octopress Blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sunnycomes.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">


<li><a href="/">Home</a></li>

<li><a href="/blog/categories/linux">Linux </a></li>

<li><a href="/blog/categories/web-server">Web&Server</a></li>

<li><a href="/blog/categories/database">Database</a></li>

<li><a href="/blog/categories/stuff">Stuff</a></li>

<li><a href="/blog/book-rack ">Bookrack</a></li>

<li><a href="/blog/about ">About</a></li>


</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Basic Practical Usage of JDBC API</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-31T14:54:53+08:00" pubdate data-updated="true">Dec 31<span>st</span>, 2013</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://sunnycomes.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>The first version is completed on 2013.12.22 20:38, the main content is from <strong><em><a href="http://alumnus.caltech.edu/~chamness/JDBC_Tuning.pdf">here</a></em></strong>, thanks to the origin author Mark Chamness.This post is dedicated to illustrate techniques for optimizing JDBC API-based calls from the Java platform. As a result of this presentation, you will:</p>

<ul>
<li>Design better JDBC implementations</li>
<li>Recognize potential performance bottlenecks</li>
<li>Make more money</li>
</ul>


<h1>Agenda</h1>

<ol>
<li>Why optimize?</li>
<li>Basic API techniques.</li>
<li>Design Strategies.</li>
</ol>


<h2>Why Optimize?</h2>

<ul>
<li>On average, a web request performs 4 database queries.</li>
<li>Experience has shown that database calls are typical performance bottleneck.</li>
<li>Bad JDBC can overwhelm the database.</li>
</ul>


<h3>SQL Statements</h3>

<p>Most flexible
Least reliable
Must be recompiled in database for each use</p>

<h4>PreparedStatement</h4>

<p>Represents a precompiled SQL statement
Can be used to efficiently execute statement multiple times
Somewhat flexible ¨Ccan create new ones as needed</p>

<h3>CallableStatement</h3>

<p>Used to execute SQL stored procedures.
Same syntax as PreparedStatement.
Least flexible.
Most optimized DB call.</p>

<h2>Cache</h2>

<p>Keep data within client to reduce the number of round-trips to the database.
Lesson: The less JDBC the better.</p>

<h2>Use Database Connection Pool</h2>

<p>Don¡¯t use DriverManager.getConnection() often. JDBC connections can take 0.5 to 2 seconds to create.
Create Pool of Connections and reuse them.
Necessity for any production system.</p>

<!-- more -->


<h2>Use multi-threading with Connection Pooling to address network latency</h2>

<p>Threads can issue queries over separate database connections.
This improves performance to a point.</p>

<pre><code>Single-batch Transactions
    BEGIN TRANSACTION
        UPDATE TABLE1... 
        INSERT INTO TABLE2¡­
        DELETE TABLE3
    COMMIT
</code></pre>

<h3>Single-batch Transactions</h3>

<p>DB obtains necessary locks on rows and tables, uses and releases them in one step
Depending on transaction type, separate statements and commits can result in more DB calls and hold DB locks longer</p>

<h3>Single-batch Transaction Types&mdash;-Significantly different effects!</h3>

<h4>java.sql.Connection</h4>

<pre><code>TRANSACTION_READ_COMMITTED 
TRANSACTION_READ_UNCOMMITTED 
TRANSACTION_REPEATABLE_READ 
TRANSACTION_SERIALIZABLE
</code></pre>

<h3>Don¡¯t have transaction span user input</h3>

<p>Application sends BEGIN TRAN and SQL, locking rows or tables for update
Application waits for user to press key before committing transaction</p>

<h4>Solution: Optimistic locking</h4>

<p>Optimistic locking employs timestamps and triggers in queries and updates
Queries select data with timestamp values
Prepare a transaction based on that data, without locking data in a transaction</p>

<h2>Smart Queries</h2>

<ul>
<li>Make queries as specific as possible</li>
<li>Put more logic into SQL statements</li>
<li>DB are designed to use SQL efficiently</li>
<li>Proper use of SQL can avoid performance problems</li>
</ul>


<p>Smart Query Ex: get employees in ENG dept   , Instead of:</p>

<pre><code>SELECT * FROM employees; 
SELECT * FROM dept;
</code></pre>

<p>(and joining on Java application side), <strong>use database join:</strong></p>

<pre><code>SELECT employees.* FROM employees E, dept D 
WHERE E.DEPTNO = D.DEPTNO AND D.DEPTTYPE = ¡®ENG¡¯;
</code></pre>

<p>Minimize ResultSet before crossing network
Many performance problems come from moving raw data around needlessly</p>

<h3>Smart Query Guidelines</h3>

<ul>
<li>Use DB for filtering</li>
<li>Use Java for business logic</li>
<li>DB does filtering very well</li>
<li>DB business logic is poor(At least very inconsistent between database vendors.)</li>
</ul>


<h3>Keep operational data set small as possible</h3>

<ul>
<li>Move non-current data to other tables and do joins for rarer historical queries</li>
<li>Otherwise, index and cluster so frequently used data is logically and physically localized</li>
</ul>


<h1>Optimization Stages</h1>

<ol>
<li>Leverage the strengths of the DB</li>
<li>Use the full range of java.sql API</li>
<li>Design for Performance ¨CConnection Pools, Multi-Threading, etc.</li>
</ol>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Your Name</span></span>

      








  


<time datetime="2013-12-31T14:54:53+08:00" pubdate data-updated="true">Dec 31<span>st</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/java/'>java</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/11/30/simple-guide-for-markdown/" title="Previous Post: Markdown Syntax Guide">&laquo; Markdown Syntax Guide</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/31/basic-practical-usage-of-jdbc-api/">Basic Practical Usage of JDBC API</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/30/simple-guide-for-markdown/">Markdown Syntax Guide</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/06/short-list-of-mysql-commands/">Short List of MySQL Commands</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'sunnycomes';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://sunnycomes.github.io/blog/2013/12/31/basic-practical-usage-of-jdbc-api/';
        var disqus_url = 'http://sunnycomes.github.io/blog/2013/12/31/basic-practical-usage-of-jdbc-api/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
